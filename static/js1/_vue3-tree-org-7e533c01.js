import{z as he,x as T,q as L,v as P,a1 as xe,$ as Q,S as ce,r as D,R as oe,T as Ae,a9 as re,W as ge,Y as ue,Z as Ne,a2 as $e,ad as we,X as ee,aa as Ke,a as be,a3 as Ze,A as Ge,f as W,p as Te,M as et,Q as qe,o as Ue,w as de,n as ve,ac as tt,K as Xe,ap as ot,ao as Ye,H as nt}from"./_@vue-5d42028f.js";const M=function(e){return Object.prototype.toString.call(e)==="[object Object]"},J=function(e){return typeof e=="string"},Z=function(e){return typeof e=="number"},U={print:(e,t,o)=>J(t)||typeof o=="boolean",pretty:(e,t,o)=>J(t)&&J(e)||typeof o=="string",primary:(e,t)=>J(e)||typeof t=="boolean",success:(e,t)=>J(e)||typeof t=="boolean",info:(e,t)=>J(e)||typeof t=="boolean",warning:(e,t)=>J(e)||typeof t=="boolean",danger:(e,t)=>J(e)||typeof t=="boolean"};function ae(e="default"){let t="";switch(e){case"primary":t="#2d8cf0";break;case"success":t="#19be6b";break;case"info":t="#909399";break;case"warning":t="#ff9900";break;case"danger":t="#ff4d4f";break;case"default":t="#35495E";break;default:t=e}return t}U.print=function(e,t="default",o=!1){return typeof e=="object"?(console.dir(e),!0):(o?console.log(`%c ${e} `,`background:${ae(t)}; padding: 2px; border-radius: 4px;color: #fff;`):console.log(`%c ${e} `,`color: ${ae(t)};`),!0)},U.pretty=function(e,t,o="primary"){return console.log(`%c ${e} %c ${t} %c`,`background:${ae(o)};border:1px solid ${ae(o)}; padding: 1px; border-radius: 4px 0 0 4px; color: #fff;`,`border:1px solid ${ae(o)}; padding: 1px; border-radius: 0 4px 4px 0; color: ${ae(o)};`,"background:transparent"),!0},U.primary=function(e,t=!1){return this.print&&this.print(e,"primary",t),!0},U.success=function(e,t=!1){return this.print&&this.print(e,"success",t),!0},U.info=function(e,t=!1){return this.print&&this.print(e,"info",t),!0},U.warning=function(e,t=!1){return this.print&&this.print(e,"warning",t),!0},U.danger=function(e,t=!1){return this.print&&this.print(e,"danger",t),!0};const se=function(){let e=!1;return{get:()=>e,set:t=>{e=t}}}(),We=function(e,t,o){const{id:l,children:p}=t;if(e[l]===o)return e;if(Array.isArray(e[p])){const m=e[p];for(let d=0,g=m.length;d<g;d++){const i=m[d],v=We(i,t,o);if(v)return v}}},at=function(e,t){const{parenNode:o,onlyOneNode:l,cloneNodeDrag:p}=t;if(o.value){const{keys:m}=t,{id:d,pid:g}=m,i=o.value.$$data,v=JSON.parse(JSON.stringify(e.$$data));if(p){(function(n,s,h){const{children:C}=s;if(M(n))$(n);else if(Array.isArray(n))for(let N=0,z=n.length;N<z;N++)$(n[N]);function $(N){if(h(N),Array.isArray(N[C])){const z=N[C];for(let k=0,b=z.length;k<b;k++)$(z[k])}}})(v,m,function(n){typeof n[d]=="string"&&n[d].indexOf("clone-node")!==-1&&(n[d]=`clone-node-${n[d]}`)});const{children:f}=m;l&&Array.isArray(v[f])&&(v[f]=[]),v[m.pid]=i[m.id],i.children?i.children.push(v):i.children=[v]}else(function(f,n){const{keys:s,data:h,onlyOneNode:C}=n,{id:$,pid:N,children:z}=s,k=We(h,s,f[N]),b=k[z];let S;for(let y=0,O=b.length;y<O;y++)if(b[y][$]===f[$]){b.splice(y,1),S=y;break}const c=f[z];C&&S!==void 0&&c&&(f[z]=[],c.forEach(y=>{y[N]=k[$]}),k[z].splice(S,0,...c))})(v,t),v[g]=i[d],i.children?i.children.push(v):i.children=[].concat(v)}},Ie={beforeMount(e,t){const{l:o,t:l}=t.modifiers,{drag:p,dragData:m,node:d,emit:g,beforeDragEnd:i,initNodes:v}=t.value,{value:f}=t,n={...m};e.addEventListener("mousedown",function(c){const y=c.target;if(p===!1||c.button!==0||d.focused||d.$$data.noDragging||y.className.indexOf("tree-org-node-btn")>-1)return!1;(function(O){O.stopPropagation(),$=O.screenX,N=O.screenY,h=0,n.contextmenu.value=!1;const{keys:I,onlyOneNode:H}=n;if(H){const{children:K}=I,V={...d.$$data};V[K]=[],n.cloneData.value=v(V)}else n.cloneData.value=v(d.$$data)})(c),document.addEventListener("mousemove",z),document.addEventListener("mouseup",k),S("start")});let s,h=0,C=!1,$=0,N=0;function z(c){return c.preventDefault(),!(Math.abs(c.screenX-$)<5&&Math.abs(c.screenY-N)<5)&&(C||(C=!0,function(y){se.set(!0),n.nodeMoving.value=!0,d.moving=!0;let O=e;for(;!O.classList.contains("tree-org-node");)h+=O.offsetLeft,O=O.offsetParent;h+=2,s=document.querySelector("#clone-tree-org"),s&&(s.style.width=`${O.clientWidth}px`,s.style.opacity="0.8",s.style.left=y.clientX-h+"px",s.style.top=y.clientY+2+"px")}(c)),o&&l&&f?(s&&(s.style.left=c.clientX-h+"px",s.style.top=c.clientY+2+"px"),void S("move")):o&&f?(e.style.left=c.clientX-h+"px",void S("move")):void(l&&f&&(e.style.top=c.clientY+"px",S("move"))))}function k(c){if(document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",k),C){if(typeof i=="function"){const y=i(d,n.parenNode.value);y&&y.then?y.then(()=>{b(c)},()=>{}):y!==!1&&b(c)}else b(c);C=!1,s=null,d.moving=!1,n.nodeMoving.value=!1,setTimeout(()=>{se.set(!1)},200)}}function b(c){const y=document.querySelector(".tree-org-node__moving");if(y&&y.contains(c.target))return S("end"),!1;at(d,n),S("end")}function S(c){c!=="start"?c!=="move"?c==="end"&&g("on-node-drag-end",d,n.parenNode.value):g("on-node-drag",d):g("on-node-drag-start",d)}}},ke={onClick:"onNodeClick",onDblclick:"onNodeDblclick",onContextmenu:"onNodeContextmenu",onMouseenter:"onNodeMouseenter",onMouseleave:"onNodeMouseleave"};function lt(e,t){if(typeof e=="function")return function(o){o.target.className.indexOf("org-tree-node-btn")>-1||e(o,t)}}const He=(e,t,o)=>!(Array.isArray(e[t])&&e[t].length>0)&&!o||e.isLeaf,Je=(e,t,o)=>{const{attrs:l}=o,p=["tree-org-node"],m=[],{expand:d,children:g,id:i}=t;return He(t,"children",l.lazy)?p.push("is-leaf"):l.collapsable&&!d&&p.push("collapsed"),t.moving&&p.push("tree-org-node__moving"),m.push(rt(e,t,o)),l.collapsable&&!d||m.push(dt(e,g,o)),ue(e("div",{class:p,key:i},m),[[Ne,!t.hidden]])},rt=(e,t,o)=>{const{attrs:l}=o,p=l.props,m=l.renderContent,{label:d}=t,g=[];if(o.slots.default)g.push(o.slots.default({node:t}));else if(typeof m=="function"){U.warning("scoped-slot header is easier to use. We recommend users to use scoped-slot header.");const c=m(e,t);c&&g.push(c)}else g.push(e("div",{class:"tree-org-node__text"},d));l.collapsable&&!He(t,"children",l.lazy)&&g.push(((c,y,O)=>{const{attrs:I}=O,H=I.onOnExpand,K=["tree-org-node__expand"];y.expand&&K.push("expanded");const V=[];return O.slots.expand?V.push(O.slots.expand({node:y})):V.push(c("span",{class:"tree-org-node__expand-btn"})),c("span",{class:K,onMousedown:X=>{X.stopPropagation()},onDblclick:X=>{X.stopPropagation()},onClick:X=>{X.stopPropagation(),H&&H(X,y)}},V)})(e,t,o));const i=["tree-org-node__inner"];let{labelStyle:v,labelClassName:f,selectedClassName:n,selectedKey:s}=l;typeof f=="function"&&(f=f(t)),f&&i.push(f),t.className&&i.push(t.className),typeof n=="function"&&(n=n(t)),s!==void 0&&(s=Array.isArray(s)?s:[s]),n&&s&&s.includes(t.id)&&i.push(n);const h=["tree-org-node__content"];t.$$root&&h.push(`is-root_${l.suffix}`),t.label||h.push("is-empty"),t.$$focused&&h.push("is-edit");const C=Ye("nodedrag"),$=[];l.vNodedrag&&C&&!t.$$root&&$.push([C,Object.assign({node:t},l.vNodedrag),"",{l:!0,t:!0}]);const N={};for(const c in ke)if(Object.prototype.hasOwnProperty.call(ke,c)){const y=l[ke[c]];y&&(N[c]=lt(y,t))}const z=l.onNodeFocus,k=l.onNodeBlur,b=Ye("focus"),S=[[Ne,t.$$focused]];return b&&S.push([b,t.$$focused]),e("div",{class:h},[ue(e("div",{class:i,style:t.style?t.style:v,...N},g),$),ue(e("textarea",{class:"tree-org-node__textarea",placeholder:"\u8BF7\u8F93\u5165\u8282\u70B9\u540D\u79F0",value:t.label,onFocus:c=>{z&&z(c,t.$$data,t)},onInput:c=>{t.label=c.target.value},onBlur:c=>{t.$$data.focused!==void 0&&(t.$$data.focused=!1),t.$$data[p.label]=c.target.value,t.$$focused=!1,k&&k(c,t.$$data,t)},onClick:c=>c.stopPropagation()}),S)])},dt=(e,t,o)=>{if(Array.isArray(t)&&t.length){const l=t.filter(p=>!p.$$hidden).map(p=>Je(e,p,o));return e("div",{class:"tree-org-node__children"},l)}return""},Le=(e,t)=>e.data?(e.data.$$root=!e.isClone,Je(Ge,e.data,t)):"";Le.directives={focus:{mounted(e,{value:t}){t&&e.focus()},updated(e,{value:t}){t&&e.focus()}},nodedrag:Ie};var Oe=he({props:{scale:String,tools:Object},setup(e,{emit:t}){const o=D(!1),l=D(!1);function p(i){l.value=!l.value,t("onFullscreen",i)}function m(){document.isFullScreen||document.mozIsFullScreen||document.webkitIsFullScreen||!l.value||p("esc")}const d=W(()=>o.value?"\u5168\u90E8\u6536\u8D77":"\u5168\u90E8\u5C55\u5F00"),g=W(()=>l.value?"\u9000\u51FA\u5168\u5C4F":"\u5168\u5C4F");return Te(()=>{window.addEventListener("resize",m)}),et(()=>{window.removeEventListener("resize",m)}),{expanded:o,fullscreen:l,expandTitle:d,fullTiltle:g,handleExpand:function(){o.value=!o.value,t("onExpand")},handleScale:function(i){i==="out"?t("onScale",.1):i==="in"?t("onScale",-.1):t("onRestore")},handleFullscreen:p}}});const st={class:"zm-tree-handle"},ct={key:0,class:"zm-tree-percent"},ut=["title"],it={class:"zm-tree-svg"},pt=[T("span",{class:"zm-tree-icon"},"+",-1)],ft=[T("span",{class:"zm-tree-icon"},"-",-1)],mt=[T("span",{class:"zm-tree-restore"},null,-1)],vt=["title"],gt={class:"zm-tree-svg"};function Pe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function Me(e,t,o,l=1){return{deltaX:Math.round(t/l/e[0])*e[0],deltaY:Math.round(o/l/e[1])*e[1]}}function le(e,t,o){return e<t?t:o<e?o:e}Oe.render=function(e,t,o,l,p,m){return L(),P("div",st,[e.tools.scale?(L(),P("div",ct,xe(e.scale),1)):Q("v-if",!0),e.tools.expand?(L(),P("div",{key:1,onClick:t[0]||(t[0]=(...d)=>e.handleExpand&&e.handleExpand(...d)),title:e.expandTitle,class:"zm-tree-handle-item"},[T("span",it,[T("i",{class:ce(["treefont",e.expanded?"icon-collapse":"icon-expand"])},null,2)])],8,ut)):Q("v-if",!0),e.tools.zoom?(L(),P("div",{key:2,onClick:t[1]||(t[1]=d=>e.handleScale("out")),title:"\u653E\u5927",class:"zm-tree-handle-item zoom-out"},pt)):Q("v-if",!0),e.tools.zoom?(L(),P("div",{key:3,onClick:t[2]||(t[2]=d=>e.handleScale("in")),title:"\u7F29\u5C0F",class:"zm-tree-handle-item zoom-in"},ft)):Q("v-if",!0),e.tools.restore?(L(),P("div",{key:4,onClick:t[3]||(t[3]=d=>e.handleScale("restore")),title:"\u8FD8\u539F",class:"zm-tree-handle-item"},mt)):Q("v-if",!0),e.tools.fullscreen?(L(),P("div",{key:5,onClick:t[4]||(t[4]=(...d)=>e.handleFullscreen&&e.handleFullscreen(...d)),title:e.fullTiltle,class:"zm-tree-handle-item"},[T("span",gt,[T("i",{class:ce(["treefont",e.fullscreen?"icon-unfullscreen":"icon-fullscreen"])},null,2)])],8,vt)):Q("v-if",!0)])},Oe.__file="src/components/tools/tools.vue";const fe=function(e,t,o,l=!1){e&&t&&o&&e.addEventListener(t,o,l)},te=function(e,t,o,l=!1){e&&t&&o&&e.removeEventListener(t,o,l)},ht=(e,{emit:t},o)=>{const l={start:"mousedown",move:"mousemove",stop:"mouseup"},p={start:"touchstart",move:"touchmove",stop:"touchend"},m={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},d={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let g=l;const i=D(e.x),v=D(e.y),f=D(e.z),n=D(e.active),s=D(!1),h=D(0),C=D(0),$=D(0),N=D(0),z=D(0),k=D(0);let b={},S={};function c(){b={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},S={minLeft:-1/0,maxLeft:1/0,minRight:-1/0,maxRight:1/0,minTop:-1/0,maxTop:1/0,minBottom:-1/0,maxBottom:1/0}}function y(){if(e.parent){const[u,R]=O();z.value=u||0,k.value=R||0}}function O(){if(e.parent&&o.eleRef.value){const u=window.getComputedStyle(o.eleRef.value.parentNode,null);return[parseInt(u.getPropertyValue("width"),10),parseInt(u.getPropertyValue("height"),10)]}return[0,0]}function I(u){if(u instanceof MouseEvent&&u.which!==1)return;const R=u.target||u.srcElement;if(R&&o.eleRef.value&&o.eleRef.value.contains(R)){if(e.dragCancel&&function(w,j,Y){let F=w;const G=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(r=>F&&Pe(F[r]))||"";if(!Pe(F[G]))return!1;do{if(F[G](j))return!0;if(F===Y)return!1;F=F.parentNode}while(F);return!1}(R,e.dragCancel,o.eleRef.value))return void(s.value=!1);n.value||(n.value=!0,t("activated"),t("update:active",!0)),e.draggable&&(s.value=!0),u instanceof MouseEvent?(b.mouseX=u.pageX,b.mouseY=u.pageY):(b.mouseX=u.touches[0].pageX,b.mouseY=u.touches[0].pageY),b.left=i.value,b.right=h.value,b.top=v.value,b.bottom=C.value,e.parent&&(S=H()),fe(document.documentElement,g.move,V),fe(document.documentElement,g.stop,X)}}function H(){const u=e.grid;return{minLeft:i.value%u[0],maxLeft:Math.floor((z.value-$.value-i.value)/u[0])*u[0]+i.value,minRight:h.value%u[0],maxRight:Math.floor((z.value-$.value-h.value)/u[0])*u[0]+h.value,minTop:v.value%u[1],maxTop:Math.floor((k.value-N.value-v.value)/u[1])*u[1]+v.value,minBottom:C.value%u[1],maxBottom:Math.floor((k.value-N.value-C.value)/u[1])*u[1]+C.value}}function K(u){const R=u.target||u.srcElement;o.eleRef.value&&!o.eleRef.value.contains(R)&&n.value&&!e.preventDeactivation&&(n.value=!1,t("deactivated"),t("update:active",!1))}function V(u){s.value&&function(R){const w=e.axis,j=e.grid;let Y=0,F=0;R instanceof MouseEvent?(Y=R.pageX,F=R.pageY):(Y=R.touches[0].pageX,F=R.touches[0].pageY);const G=w&&w!=="y"?b.mouseX-Y:0,r=w&&w!=="x"?b.mouseY-F:0,{deltaX:a,deltaY:x}=Me(j,G,r,e.scale),E=le(b.left-a,S.minLeft,S.maxLeft),_=le(b.top-x,S.minTop,S.maxTop),B=le(b.right+a,S.minRight,S.maxRight),A=le(b.bottom+x,S.minBottom,S.maxBottom);i.value=E,v.value=_,h.value=B,C.value=A,t("dragging",i.value,v.value)}(u)}function X(){c(),s.value&&(s.value=!1,t("dragstop",i.value,v.value))}qe(()=>{c()}),Te(()=>{!e.enableNativeDrag&&o.eleRef.value&&(o.eleRef.value.ondragstart=()=>!1);const[u,R]=O();if(z.value=u,k.value=R,o.eleRef.value){const[w,j]=function(Y){const F=window.getComputedStyle(Y);return[parseFloat(F.getPropertyValue("width")),parseFloat(F.getPropertyValue("height"))]}(o.eleRef.value);$.value=w,N.value=j,h.value=z.value-$.value-i.value,C.value=k.value-N.value-v.value}fe(document.documentElement,"mousedown",K),fe(document.documentElement,"touchend touchcancel",K),fe(window,"resize",y)}),Ue(()=>{te(document.documentElement,"mousedown",K),te(document.documentElement,"touchstart",X),te(document.documentElement,"mousemove",V),te(document.documentElement,"touchmove",V),te(document.documentElement,"mouseup",X),te(document.documentElement,"touchend touchcancel",K),te(window,"resize",y)});const De=W(()=>({transform:`translate(${i.value}px, ${v.value}px)`,zIndex:f.value,...s.value&&e.disableUserSelect?m:d}));return de(()=>e.active,u=>{n.value=u,t(u?"activated":"deactivated")}),de(()=>e.z,u=>{(u>=0||u==="auto")&&(f.value=u)}),de(()=>e.x,u=>{s.value||(e.parent&&(S=H()),function(R){const{deltaX:w}=Me(e.grid,R,v.value,e.scale),j=le(w,S.minLeft,S.maxLeft);i.value=j,h.value=z.value-$.value-j}(u))}),de(()=>e.y,u=>{s.value||(e.parent&&(S=H()),function(R){const{deltaY:w}=Me(e.grid,i.value,R,e.scale),j=le(w,S.minTop,S.maxTop);v.value=j,C.value=k.value-N.value-j}(u))}),{enabled:n,dragging:s,style:De,resetBoundsAndMouseState:c,elementTouchDown:function(u){g=p,I(u)},elementMouseDown:function(u){g=l,I(u)}}},_e=Symbol("wrapper");function yt(e,t){if((o=e)===null||typeof o!="object"||e.__elPropsReservedKey)return e;var o;const{values:l,required:p,default:m,type:d,validator:g}=e,i=l||g?v=>{let f=!1,n=[];if(l&&(n=[...l,m],f=f||n.includes(v)),g&&(f=f||g(v)),!f&&n.length>0){const s=[...new Set(n)].map(h=>JSON.stringify(h)).join(", ");nt(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${s}], got value ${JSON.stringify(v)}.`)}return f}:void 0;return{type:typeof d=="object"&&Object.getOwnPropertySymbols(d).includes(_e)?d[_e]:d,validator:i,__elPropsReservedKey:!0,default:m,required:!!p}}const Se=e=>function(t){let o=-1;const l=t?t.length:0,p={};for(;++o<l;){const m=t[o];p[m[0]]=m[1]}return p}(Object.entries(e).map(([t,o])=>[t,yt(o,t)])),ne=e=>({[_e]:e});var Re=he({replace:!0,name:"Draggable",props:Se({className:{type:String,default:"zm-draggable"},classNameDraggable:{type:String,default:"draggable"},classNameDragging:{type:String,default:"dragging"},classNameActive:{type:String,default:"active"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},x:{type:Number,default:0},y:{type:Number,default:0},z:{type:[String,Number],default:"auto",validator:e=>typeof e=="string"?e==="auto":e>=0},dragCancel:String,axis:{type:String,default:"both",validator:e=>["x","y","both"].includes(e)},grid:{type:Array,default:()=>[1,1]},parent:{type:Boolean,default:!1},scale:{type:Number,default:1,validator:e=>e>0}}),emits:{activated:()=>!0,deactivated:()=>!0,dragging:(e,t)=>Z(e)&&Z(t),dragstop:(e,t)=>Z(e)&&Z(t),"update:active":e=>typeof e=="boolean"},setup(e,t){const o=D(),l=ht(e,t,{eleRef:o});return{top,eleRef:o,...l}}});Re.render=function(e,t,o,l,p,m){return L(),P("div",{style:Ae(e.style),class:ce([{[e.classNameActive]:e.enabled,[e.classNameDragging]:e.dragging,[e.classNameDraggable]:e.draggable},e.className]),ref:"eleRef",onMousedown:t[0]||(t[0]=(...d)=>e.elementMouseDown&&e.elementMouseDown(...d)),onTouchstart:t[1]||(t[1]=(...d)=>e.elementTouchDown&&e.elementTouchDown(...d))},[oe(e.$slots,"default")],38)},Re.__file="src/components/draggable/src/draggable.vue";var Be=he({components:{TreeOrgNode:Le},props:Se({data:{type:Object,required:!0},props:{type:ne(Object)},modelValue:Boolean,horizontal:Boolean,selectedKey:String,collapsable:Boolean,renderContent:Function,labelStyle:Object,labelClassName:{type:[Function,String]}}),setup:(e,t)=>({defaultSlot:!!t.slots.default,expandSlot:!!t.slots.expand})});Be.render=function(e,t,o,l,p,m){const d=re("tree-org-node");return L(),ge(Ke,{to:"body"},[ue(T("div",{id:"clone-tree-org",class:ce(["clone-tree-org tree-org",{horizontal:e.horizontal,collapsable:e.collapsable}])},[$e(d,{data:e.data,props:e.props,isClone:!1,horizontal:e.horizontal,labelStyle:e.labelStyle,collapsable:e.collapsable,renderContent:e.renderContent,labelClassName:e.labelClassName},we({_:2},[e.defaultSlot?{name:"default",fn:ee(({node:g})=>[oe(e.$slots,"default",{node:g})])}:void 0,e.expandSlot?{name:"expand",fn:ee(({node:g})=>[oe(e.$slots,"expand",{node:g})])}:void 0]),1032,["data","props","horizontal","labelStyle","collapsable","renderContent","labelClassName"])],2),[[Ne,e.modelValue]])])},Be.__file="src/components/clone-org/clone-org.vue";const bt=(e,{emit:t},o)=>{const l=D("");function p(f,n,s){if(f[n]===s)return f;if(Array.isArray(f.children)){const h=f.children;for(let C=0,$=h.length;C<$;C++){const N=p(h[C],n,s);if(N)return N}}}function m(){const{props:f,data:n,node:s}=e;if(e.nodeDelete)return void e.nodeDelete(s.$$data);if(s.$$root)return void U.pretty("[\u63D0\u793A] ","\u6839\u8282\u70B9\u4E0D\u5141\u8BB8\u5220\u9664","danger");const{id:h,children:C}=f,$=p(n,h,s.pid);if($){const N=$[C];for(let z=0,k=N.length;z<k;z++)if(N[z][h]===s.id){N.splice(z,1),t("onNodeDelete",s.$$data,s);break}}}function d(){const{nodeEdit:f,node:n}=e;f?f(n.$$data):(n.$$focused=!0,t("onNodeFocus",n.$$data))}function g(f){if(e.modelValue){if(o.eleRef.value&&o.eleRef.value.contains(f.target))return!1;t("update:modelValue",!1)}}const i=W(()=>({left:`${e.x}px`,top:`${e.y}px`})),v=W(()=>!e.disabled&&!e.node.disabled);return Te(()=>{document.addEventListener("mousedown",g)}),Ue(()=>{document.removeEventListener("mousedown",g)}),{position:i,editable:v,handleMenu:function(f){const n=f.target;if(n.className==="zm-tree-menu-item"){const s=n.getAttribute("action");switch(s){case"copy":(function(){if(e.nodeCopy)return void e.nodeCopy(e.node.$$data);l.value=e.node.label,ve(()=>{o.inputRef&&o.inputRef.value&&(o.inputRef&&o.inputRef.value.select(),navigator.clipboard.writeText(l.value).then(function(){U.pretty("[\u63D0\u793A] ","\u6587\u672C\u590D\u5236\u6210\u529F","success")},function(){U.pretty("[\u9519\u8BEF] ","\u6D4F\u89C8\u5668\u4E0D\u652F\u6301","danger")}),t("onNodeCopy",l.value))})})();break;case"add":(function(){if(e.nodeAdd)return void e.nodeAdd(e.node.$$data);const{id:h,pid:C,label:$,expand:N,children:z}=e.props,{node:k}=e,b={[h]:String(new Date().getTime()),[C]:k.id,[$]:"",[N]:!1,[z]:[],newNode:!0,focused:!0};Array.isArray(k.children)?k.$$data[z].push(b):k.$$data[z]=[b],t("onNodeFocus",b)})();break;case"edit":d();break;case"delete":m()}t("contextmenu",{command:s,node:e.node,data:e.node.$$data}),t("update:modelValue",!1)}},handleEdit:d,handleClose:g,afterEnter:function(){t("opened")},afterLeave:function(){t("closed")}}};var Fe=he({name:"Contextmenu",props:Se({modelValue:{type:Boolean,required:!0},data:{type:Object,required:!0},node:{type:ne(Object),required:!0},props:{type:ne(Object)},x:Number,y:Number,menus:{type:ne(Array)},nodeAdd:Function,nodeDelete:Function,nodeEdit:Function,nodeCopy:Function,disabled:Boolean}),emits:{onNodeDelete:(e,t)=>M(e)&&M(t),onNodeCopy:e=>J(e),contextmenu:e=>M(e),onNodeFocus:e=>M(e),opened:()=>!0,closed:()=>!0,"update:modelValue":e=>typeof e=="boolean"},setup(e,t){const o=D(),l=D();return{eleRef:l,inputRef:o,copyText:D(""),oldData:be({}),...bt(e,t,{inputRef:o,eleRef:l})}}});const xt=["action"];Fe.render=function(e,t,o,l,p,m){return L(),ge(Ke,{to:"body"},[$e(Ze,{name:"dialog-fade",onAfterEnter:e.afterEnter,onAfterLeave:e.afterLeave,persisted:""},{default:ee(()=>[ue(T("div",{style:Ae(e.position),onClick:t[1]||(t[1]=(...d)=>e.handleMenu&&e.handleMenu(...d)),ref:"eleRef",class:"zm-tree-contextmenu"},[T("ul",null,[(L(!0),P(Xe,null,tt(e.menus,d=>(L(),P(Xe,null,[e.editable||!["add","edit","delete"].includes(d.command)?(L(),P("li",{class:"zm-tree-menu-item",action:d.command,key:d.command},xe(d.name),9,xt)):Q("v-if",!0)],64))),256))]),ue(T("textarea",{class:"copy-textarea",ref:"inputRef","onUpdate:modelValue":t[0]||(t[0]=d=>e.copyText=d)},null,512),[[ot,e.copyText]])],4),[[Ne,e.modelValue]])]),_:1},8,["onAfterEnter","onAfterLeave"])])},Fe.__file="src/components/contextmenu/src/contextmenu.vue";const $t=[{name:"\u590D\u5236\u6587\u672C",command:"copy"},{name:"\u65B0\u589E\u8282\u70B9",command:"add"},{name:"\u7F16\u8F91\u8282\u70B9",command:"edit"},{name:"\u5220\u9664\u8282\u70B9",command:"delete"}],Nt=Se({data:{type:Object,required:!0},props:{type:ne(Object),default:()=>({id:"id",pid:"pid",label:"label",expand:"expand",children:"children"})},toolBar:{type:[Object,Boolean],default:()=>({expand:!0,scale:!0,zoom:!0,restore:!0,fullscreen:!0})},disabled:{type:Boolean,default:!1},scalable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!0},draggableOnNode:{type:Boolean,default:!1},nodeDraggable:{type:Boolean,default:!0},cloneNodeDrag:{type:Boolean,default:!0},onlyOneNode:{type:Boolean,default:!0},clickDelay:{type:Number,default:260},lazy:Boolean,load:{type:ne(Function)},defaultExpandLevel:Number,defaultExpandKeys:{type:Array,default:()=>[]},beforeDragEnd:Function,horizontal:Boolean,selectedKey:{type:[Array,String,Number]},collapsable:Boolean,renderContent:Function,labelStyle:Object,labelClassName:{type:[Function,String]},selectedClassName:{type:[Function,String]},defineMenus:{type:ne([Array,Function]),default:()=>$t},nodeAdd:Function,nodeDelete:Function,nodeEdit:Function,nodeCopy:Function,filterNodeMethod:Function}),St=(e,{emit:t},o)=>{const l=D(0),p=D(0),m=D(!1);function d(r,a){const x=o.zoomRef.value,E=o.treeRef.value,_=x.clientWidth/2,B=x.clientHeight/2;let A=x.clientHeight-E.clientHeight,q=x.clientWidth-E.clientWidth;A>0&&(A=0),q>0&&(q=0),l.value=r>_?_:r<q?q:r,p.value=a<A?A:a>B?B:a}function g(r,a){d(r,a),setTimeout(()=>{se.set(!1)},200),t("on-drag-stop",{x:r,y:a})}const i=D(!1),v=be({value:{}}),f=D(!1),n=D(0),s=D(0),h=D({}),C=D([]),$=D(1);function N(r){if(!e.scalable)return;const a=Number((Number($.value)+r).toFixed(1));$.value=r>0?Math.min(3,a):Math.max(.3,a)}function z(r,a,x){m.value=!0;const E=r.offsetLeft-a,_=r.offsetTop-x;l.value-=E,p.value-=_,d(l.value,p.value)}let k;const b=be(Object.assign({id:"id",pid:"pid",label:"label",expand:"expand",children:"children",isLeaf:"isLeaf"},e.props)),S=D(!1);function c(r){r.forEach(a=>{a.expand&&(a.expand=!1,w.delete(a.id)),a.children&&c(a.children)})}const y=D(!1);function O(r,a){Array.isArray(r)?r.forEach(x=>{x.expand=a,a&&w.add(x.id),x.children&&O(x.children,a)}):(r.expand=a,a&&w.add(r.id),r.children&&O(r.children,a))}function I(r){Y.value=j(r)}const H=W(()=>({width:100/$.value+"%",height:100/$.value+"%",transform:`scale(${$.value})`})),K=W(()=>`${Math.round(100*$.value)}%`),V=W(()=>e.draggableOnNode&&!e.nodeDraggable?"":`.tree-org-node__content:not(.is-root_${G})>.tree-org-node__inner`),X=W(()=>y.value?"\u6536\u8D77\u5168\u90E8\u8282\u70B9":"\u5C55\u5F00\u5168\u90E8\u8282\u70B9"),De=W(()=>y.value?"\u6536\u8D77\u5168\u90E8\u8282\u70B9":"\u5C55\u5F00\u5168\u90E8\u8282\u70B9"),u=D({}),R=W(()=>{const{cloneNodeDrag:r,onlyOneNode:a,data:x}=e;return{drag:e.nodeDraggable,dragData:{keys:b,nodeMoving:i,stopClick:se,parenNode:v,cloneNodeDrag:r,onlyOneNode:a,contextmenu:f,cloneData:u,data:x},beforeDragEnd:e.beforeDragEnd,initNodes:j,emit:t}});de(()=>e.horizontal,()=>{ve(()=>{g(l.value,p.value)})});let w=new Set(e.defaultExpandKeys);function j(r){const{defaultExpandLevel:a=0}=e,x=(E,_)=>{const{id:B,label:A,pid:q,expand:ze,children:ie,isLeaf:Ce}=b,ye={};Object.keys(E).map(pe=>{["hidden","disabled","className","style"].includes(pe)&&(ye[pe]=E[pe])});const je=E[ie],Qe=_+1,Ve=E[ze],Ee=E[B];return(Ve||Ve===void 0&&_<a)&&w.add(Ee),{...ye,id:Ee,label:E[A],pid:E[q],expand:w.has(Ee),children:je?je.map(pe=>x(pe,Qe)):void 0,isLeaf:E[Ce],$$level:_,$$data:E,$$focused:E.focused||!1}};return x(r,0)}const Y=D(j(e.data));de(()=>e.data,(r,a)=>{r!==a&&(w=new Set(e.defaultExpandKeys)),I(e.data)},{deep:!0});const F=be({visible:!0,data:{expand:!0,scale:!0,zoom:!0,restore:!0,fullscreen:!0}});qe(()=>{typeof e.toolBar=="object"?Object.assign(F.data,e.toolBar):e.toolBar||(F.visible=!1)});const G=function(r){r=r||32;const a="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",x=a.length;let E="";for(let _=0;_<r;_++)E+=a.charAt(Math.floor(Math.random()*x));return E}(6);return{keys:b,left:l,top:p,menuX:n,menuY:s,suffix:G,nodeMoving:i,zoomStyle:H,tools:F,zoomPercent:K,dragCancel:V,expandTitle:X,fullTiltle:De,nodeargs:R,expanded:y,fullscreen:S,treeData:Y,autoDragging:m,contextmenu:f,nodeMenus:C,menuData:h,cloneData:u,filter:function(r){const a=e.filterNodeMethod;if(!a)throw new Error("[Tree] filterNodeMethod is required when filter");const x=function(E){const _=E.children||[];if(_.forEach(B=>{B.$$hidden=!a.call(B,r,B),x(B)}),E.$$hidden&&_.length){let B=!0;B=_.some(A=>!A.$$hidden),E.$$hidden=!B}r&&!E.$$hidden&&E.children&&(E.expand=!0)};x(Y.value)},setData:I,zoomWheel:function(r){e.scalable&&(r.preventDefault(),r.deltaY<0?N(.1):N(-.1),t("on-zoom",$.value))},onDrag:function(r,a){se.set(!0),m.value=!1,l.value=r,p.value=a,t("on-drag",{x:r,y:a})},onDragStop:g,expandChange:function(){y.value=!y.value,O(Y.value,y.value),t("on-expand-all",y.value),y.value||(w.clear(),ve(()=>{g(l.value,p.value)}))},handleFullscreen:function(r){S.value=!S.value,r!=="esc"&&(S.value?function(){const a=o.eleRef.value;a.requestFullscreen&&a.requestFullscreen()}():document.exitFullscreen&&document.exitFullscreen())},zoomOrgchart:N,restoreOrgchart:function(){$.value=1,l.value=0,p.value=0,t("on-restore")},handleExpand:function(r,a){r.stopPropagation();const x=document.querySelector(`.is-root_${G}`);if(x){const E=x.offsetLeft,_=x.offsetTop;a.expand=!a.expand;let B=!0;a.expand?(w.add(a.id),e.lazy&&e.load&&(B=!1,function(A,q,ze){q(A,(ie,Ce)=>{const{children:ye}=b;A.isLeaf=!ie.length,ie.length&&(A.$$data[ye]=ie,Ce&&ze())})}(a,e.load,()=>{ve(()=>{z(x,E,_)})}))):!a.expand&&a.children&&(w.delete(a.id),c(a.children)),ve(()=>{B&&z(x,E,_)}),t("on-expand",r,a.$$data,a)}},getExpandKeys:function(){return[...w]},setExpandKeys:function(r){w=new Set(r),I(e.data)},nodeMouseenter:function(r,a){return i.value&&(v.value=a),t("on-node-mouseenter",r,a.$$data,a),!0},nodeMouseleave:function(r,a){return i.value&&(v.value=null),t("on-node-mouseleave",r,a.$$data,a),!0},nodeContextmenu:function(r,a){r.stopPropagation(),r.preventDefault();const{defineMenus:x}=e;Array.isArray(x)?C.value=x:typeof x=="function"&&(C.value=x(r,a)||[]),f.value=!0,n.value=r.clientX,s.value=r.clientY,h.value=a},handleBlur:function(r,a,x){const{id:E,label:_}=b,B=h.value.children||[];for(let A=B.length;A>0;A--){const q=B[A-1];if(q[E]===""&&q[_]===""){B.splice(A-1,1);break}}t("on-node-blur",r,a,x)},handleClick:function(r,a){se.get()||(clearTimeout(k),k=setTimeout(()=>{t("on-node-click",r,a.$$data,a)},e.clickDelay))},handleDblclick:function(r,a){clearTimeout(k),t("on-node-dblclick",r,a.$$data,a)}}};var me=he({name:"vue3TreeOrg",components:{Tools:Oe,CloneOrg:Be,Draggable:Re,Contextmenu:Fe,TreeOrgNode:Le},directives:{nodedrag:Ie},props:Nt,emits:{"on-drag":({x:e,y:t})=>Z(e)&&Z(t),"on-drag-stop":({x:e,y:t})=>Z(e)&&Z(t),"on-restore":()=>!0,"on-zoom":e=>Z(e),"on-expand":(e,t,o)=>e instanceof MouseEvent&&M(o)&&M(t),"on-expand-all":e=>typeof e=="boolean","on-node-blur":(e,t,o)=>e instanceof FocusEvent&&M(o)&&M(t),"on-node-click":(e,t,o)=>e instanceof MouseEvent&&M(o)&&M(t),"on-node-dblclick":(e,t,o)=>e instanceof MouseEvent&&M(o)&&M(t),"on-node-mouseenter":(e,t,o)=>e instanceof MouseEvent&&M(o)&&M(t),"on-node-mouseleave":(e,t,o)=>e instanceof MouseEvent&&M(o)&&M(t),"on-contextmenu":e=>M(e),"on-node-copy":e=>J(e),"on-node-delete":e=>M(e),"on-node-drag-start":e=>M(e),"on-node-drag":e=>M(e),"on-node-drag-end":(e,t)=>M(e)&&M(t),"on-node-focus":(e,t,o)=>e instanceof FocusEvent&&M(o)&&M(t)},setup(e,t){const o=!!t.slots.default,l=!!t.slots.expand,p=D(),m=D(),d=D();return{eleRef:p,treeRef:m,zoomRef:d,defaultSlot:o,expandSlot:l,...St(e,t,{eleRef:p,treeRef:m,zoomRef:d})}}});const Dt={ref:"eleRef",class:"zm-tree-org"},zt={class:"tree-org-node__text"},Ct=T("span",{class:"tree-org-node__expand-btn"},null,-1),Et={class:"tree-org-node__text"},kt=T("span",{class:"tree-org-node__expand-btn"},null,-1);me.render=function(e,t,o,l,p,m){const d=re("tree-org-node"),g=re("Draggable"),i=re("Tools"),v=re("clone-org"),f=re("Contextmenu");return L(),P("div",Dt,[T("div",{ref:"zoomRef",class:"zoom-container",style:Ae(e.zoomStyle),onWheel:t[1]||(t[1]=(...n)=>e.zoomWheel&&e.zoomWheel(...n))},[$e(g,{x:e.left,y:e.top,class:ce({dragging:e.autoDragging}),onDragging:e.onDrag,onDragstop:e.onDragStop,draggable:e.draggable,"drag-cancel":e.dragCancel},{default:ee(()=>[T("div",{ref:"treeRef",class:ce(["tree-org",{horizontal:e.horizontal,collapsable:e.collapsable}])},[$e(d,{data:e.treeData,props:e.keys,lazy:e.lazy,suffix:e.suffix,horizontal:e.horizontal,labelStyle:e.labelStyle,collapsable:e.collapsable,renderContent:e.renderContent,selectedKey:e.selectedKey,defaultExpandLevel:e.defaultExpandLevel,selectedClassName:e.selectedClassName,labelClassName:e.labelClassName,vNodedrag:e.nodeargs,onOnExpand:e.handleExpand,onNodeClick:e.handleClick,onNodeDblclick:e.handleDblclick,onNodeMouseenter:e.nodeMouseenter,onNodeMouseleave:e.nodeMouseleave,onNodeContextmenu:e.nodeContextmenu,onNodeFocus:t[0]||(t[0]=(n,s,h)=>{e.$emit("on-node-focus",n,s,h)}),onNodeBlur:e.handleBlur},we({_:2},[e.defaultSlot?{name:"default",fn:ee(({node:n})=>[oe(e.$slots,"default",{node:n},()=>[T("div",zt,[T("span",null,xe(n.label),1)])])])}:void 0,e.expandSlot?{name:"expand",fn:ee(({node:n})=>[oe(e.$slots,"expand",{node:n},()=>[Ct])])}:void 0]),1032,["data","props","lazy","suffix","horizontal","labelStyle","collapsable","renderContent","selectedKey","defaultExpandLevel","selectedClassName","labelClassName","vNodedrag","onOnExpand","onNodeClick","onNodeDblclick","onNodeMouseenter","onNodeMouseleave","onNodeContextmenu","onNodeBlur"])],2)]),_:3},8,["x","y","class","onDragging","onDragstop","draggable","drag-cancel"])],36),e.tools.visible?(L(),ge(i,{key:0,tools:e.tools.data,scale:e.zoomPercent,onOnExpand:e.expandChange,onOnScale:e.zoomOrgchart,onOnRestore:e.restoreOrgchart,onOnFullscreen:e.handleFullscreen},null,8,["tools","scale","onOnExpand","onOnScale","onOnRestore","onOnFullscreen"])):Q("v-if",!0),e.nodeDraggable?(L(),ge(v,{key:1,modelValue:e.nodeMoving,"onUpdate:modelValue":t[2]||(t[2]=n=>e.nodeMoving=n),props:e.keys,data:e.cloneData,horizontal:e.horizontal,"label-style":e.labelStyle,collapsable:e.collapsable,"render-content":e.renderContent,"label-class-name":e.labelClassName},we({_:2},[e.defaultSlot?{name:"default",fn:ee(({node:n})=>[oe(e.$slots,"default",{node:n},()=>[T("div",Et,[T("span",null,xe(n[e.keys.label]),1)])])])}:void 0,e.expandSlot?{name:"expand",fn:ee(({node:n})=>[oe(e.$slots,"expand",{node:n},()=>[kt])])}:void 0]),1032,["modelValue","props","data","horizontal","label-style","collapsable","render-content","label-class-name"])):Q("v-if",!0),e.nodeMenus.length?(L(),ge(f,{key:2,modelValue:e.contextmenu,"onUpdate:modelValue":t[3]||(t[3]=n=>e.contextmenu=n),x:e.menuX,y:e.menuY,node:e.menuData,data:e.data,props:e.keys,menus:e.nodeMenus,disabled:e.disabled,"node-add":e.nodeAdd,"node-delete":e.nodeDelete,"node-edit":e.nodeEdit,"node-copy":e.nodeCopy,onContextmenu:t[4]||(t[4]=n=>{e.$emit("on-contextmenu",n)}),onOnNodeCopy:t[5]||(t[5]=n=>{e.$emit("on-node-copy",n)}),onOnNodeDelete:t[6]||(t[6]=n=>{e.$emit("on-node-delete",n)})},null,8,["modelValue","x","y","node","data","props","menus","disabled","node-add","node-delete","node-edit","node-copy"])):Q("v-if",!0)],512)},me.__file="src/components/tree-org/src/tree.vue",me.install=function(e){e.component(me.name,me)};export{me as D};
//# sourceMappingURL=_vue3-tree-org-7e533c01.js.map
